# 推論段階（stage1〜5）の設計
本デモでは、日本語対話における文脈理解を単一の処理やブラックボックス的判断として扱わず、  
**段階的な推論プロセス（stage1〜5）**として分解して実装している。

この設計は、「どのように文脈理解が成立したか」を説明可能な形で示すことを目的としている。

---

## stage1：基本的な文脈推定
### 目的
発話の表層構造および明示情報から、文脈の大枠となる候補を生成する。

### 主な処理内容
- 主語・述語・目的語の把握
- 判断・依頼・評価などの発話タイプの識別
- 明示的に書かれている情報のみを扱う

### 特徴
- 暗黙の意図や感情は扱わない
- 文脈タイプ（A/B/C）の候補が初期化される段階

---

## stage2：最小限の聞き返し
### 目的
解釈に必要な情報が不足していないか、文脈が一意に確定可能かを検討する。

### 主な処理内容
- 曖昧な指示語・省略表現の検出
- 判断主体や理由が欠落しているかの確認
- 複数解釈が成立するかの判定

### 特徴
- 実際に聞き返すのではなく、**聞き返しが必要かどうかを推論する**
- 「分かったふり」を避けるための段階

---

## stage3：因果関係推定
### 目的
発話が生じた背景や動機を推定し、なぜその発話が選ばれたのかを考慮する。

### 主な処理内容
- 発話と前後文脈の因果関係の推定
- 行動や判断の理由の補完
- 感情や立場が発話に影響している可能性の検討

### 特徴
- 感情・含み・判断委ねの分岐が生じやすい段階
- 文脈タイプB・Cの判定に強く関与する

---

## stage4：修飾構造の理解
### 目的
評価語、態度表現、緩和表現などの修飾構造を解釈し、発話のニュアンスを把握する。

### 主な処理内容
- 「別に」「まぁ」「〜そう」などの語の解釈
- 直接言及されない感情や態度の推定
- 含み・遠回しな不満・強がりの検出

### 特徴
- 表層解釈と意図の乖離が顕在化しやすい
- 文脈タイプB（感情・含み型）の核心部分

---

## stage5：名詞間の格関係推定
### 目的
行為・判断・責任の主体を明確化し、  
文脈上の役割関係を確定する。

### 主な処理内容
- 誰が行うのか、誰が決めるのかの推定
- 責任の所在の明示／曖昧化の検出
- 判断主体が相手や状況に委ねられているかの判定

### 特徴
- 文脈タイプC（判断委ね型）の決定的段階
- 発話そのものよりも、**役割関係の配置**が問題となる

---

## 推論段階と文脈タイプの関係
文脈タイプの分類は、単一の stage で決定されるものではない。

- stage1〜2：文脈候補の生成
- stage3〜4：候補の絞り込み
- stage5：最終的な確定

という流れで、段階的に文脈が特定される。

---

## 補足
本設計は、人間が日常会話において無意識に行っている推論過程を可能な限り分解・明示化したものである。

精度の最大化ではなく、**理解の構造を示すこと**を主眼としている点に留意されたい。
